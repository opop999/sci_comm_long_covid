---
title: 'SciComm: Long Covid'
subtitle: "test"
author: "Ondrej Pekacek"
date: "`r  format(Sys.Date(),'%d %B, %Y')`"
output:
  html_document:
    theme: united
    highlight: tango
    css: "src/style.css"
bibliography: src/references.bib
csl: src/apa.csl
nocite: '@*'


---

![Photo by <a href="https://unsplash.com\@harashog?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Sarah G.</a> on <a href="https://unsplash.com/s/photos/confused-dog?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>](img/header.jpg)

```{r install_packages, include=FALSE, cache=TRUE}

# Package names
packages <- c("dplyr", "readr", "ggplot2", "coronavirus", "plotly", "gtrendsR", "medrxivr")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))

# Update the dataset from coronavirus package to get newest stats
update_dataset(silence = TRUE)
```

```{r get_covid_data, echo=FALSE, cache=TRUE}

# Summarize the data to get weekly new Covid cases for all countries combined
weekly_new_cases <- coronavirus %>% 
  filter(type == "confirmed" & date < as.Date("2022-07-01")) %>%
  mutate(week = as.Date(cut(date, breaks = "weeks", start.on.monday = TRUE))) %>% 
  group_by(week) %>%
  summarise(million_new_cases = sum(cases)/1000000)

(weekly_new_cases %>% 
  ggplot(aes(x = week, y = million_new_cases)) +
  geom_line(color = "#1a53ff") +
  geom_point(size = 0.5, color = "#1a53ff") +
  ylab(element_blank()) +
  xlab(element_blank()) +
  labs(title = "Weekly confirmed COVID-19 cases, all countries (in million)") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        axis.text = element_text(size = 7),
        plot.background = element_rect(fill = "grey90"),
        plot.title = element_text(face = "bold", size = 14),
        axis.title.y = element_text(size = 8),
        legend.title = element_blank(),
        legend.text = element_text(size = 9),
        legend.key = element_rect(fill = NA),
        legend.background = element_rect(fill = NA),
        plot.margin = margin(10,30,25,5, "pt")) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b-%y") +
  scale_y_continuous(
  expand = c(0, 0),
  breaks = seq(0, 100, 5),
  labels = seq(0, 100, 5),
  limits = c(0, max(weekly_new_cases$million_new_cases) + 1))
  ) %>%
  ggplotly() %>% 
  layout(annotations = 
          list(x = 1,
               y = -0.15, 
                text = "Data: Dong et al., 2020",
                showarrow = FALSE,
                xref='paper',
                yref='paper',
                font = list(size = 10)
               ))


```

```{r get_gtrends, cache=TRUE}

```

## Our sources


